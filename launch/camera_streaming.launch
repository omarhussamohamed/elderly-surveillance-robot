<!-- 
  ⚠️ DEPRECATED LEGACY FILE ⚠️
  
  This launch file is OBSOLETE. Use kvs_stream.launch instead.
  
  WARNING: Contains hardcoded AWS credentials (security risk)
  WARNING: May conflict with kvs_stream.launch (both access /dev/video0)
  
  Kept for backward compatibility only. Will be removed in future releases.
  
  Migration:
    OLD: roslaunch elderly_bot camera_streaming.launch
    NEW: roslaunch elderly_bot kvs_stream.launch
  
  See SYSTEM_OVERVIEW.md for details.
  
  Original usage (deprecated):
    roslaunch elderly_bot camera_streaming.launch
    roslaunch elderly_bot camera_streaming.launch enable_kvs:=false
-->

<launch>
  <!-- Arguments -->
  <arg name="device" default="/dev/video0" />
  <arg name="width" default="1280" />
  <arg name="height" default="720" />
  <arg name="fps" default="30" />
  <arg name="enable_kvs" default="true" />
  <arg name="bitrate" default="2048" /> <!-- kbps -->

  <!-- Camera Publisher Node -->
  <node pkg="elderly_bot" type="camera_node.py" name="camera_publisher" output="screen">
    <param name="device" value="$(arg device)" />
    <param name="width" value="$(arg width)" />
    <param name="height" value="$(arg height)" />
    <param name="fps" value="$(arg fps)" />
    <param name="frame_id" value="camera_link" />
  </node>

  <!-- AWS Kinesis Video Streams Node with Hardcoded Credentials -->
  <node pkg="elderly_bot" type="kvs_streamer_node.py" name="kvs_streamer" 
        output="screen" if="$(arg enable_kvs)">
    <!-- Hardcoded AWS Credentials for RobotStream -->
    <env name="AWS_ACCESS_KEY_ID" value="AKIAQFLXNXMMILSXZBPW" />
    <env name="AWS_SECRET_ACCESS_KEY" value="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" />
    <env name="AWS_DEFAULT_REGION" value="eu-west-1" />
    <env name="KVS_STREAM_NAME" value="RobotStream" />
    
    <param name="device" value="$(arg device)" />
    <param name="width" value="$(arg width)" />
    <param name="height" value="$(arg height)" />
    <param name="fps" value="$(arg fps)" />
    <param name="bitrate" value="$(arg bitrate)" />
  </node>

  <!-- Static transform for camera frame (adjust based on your robot's camera position) -->
  <!-- NOTE: Camera frame is now defined in elderly_bot.urdf, published by robot_state_publisher -->
  <!-- This static_transform_publisher is a fallback if URDF is not loaded -->
  <!-- Remove this node if running with bringup.launch (which loads URDF) -->
  <!--
  <node pkg="tf" type="static_transform_publisher" name="camera_tf_broadcaster" 
        args="0.15 0 0.25 0 0 0 base_link camera_link 100" />
  -->

</launch>
