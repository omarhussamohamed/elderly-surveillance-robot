<?xml version="1.0"?>
<!--
  Elderly Bot Mapping Launch File
  
  MODE 1: Autonomous Mapping
  
  Starts:
  - Hardware bringup
  - robot_localization EKF (wheel odom + IMU fusion)
  - gmapping (SLAM)
  - explore_lite (autonomous exploration)
  
  Usage:
    roslaunch elderly_bot mapping.launch
    
  To save the map when exploration is complete:
    rosrun map_server map_saver -f ~/catkin_ws/src/elderly_bot/maps/my_house
-->
<launch>
  <!-- ========== ARGUMENTS ========== -->
  <arg name="rviz" default="false" doc="Set to true to enable RViz visualization" />
  
  <!-- ========== BRINGUP HARDWARE ========== -->
  <!-- Includes: rosserial, lidar, IMU pipeline, EKF -->
  
  <include file="$(find elderly_bot)/launch/bringup.launch" />
  
  <!-- ========== GMAPPING (SLAM) ========== -->
  
  <node pkg="gmapping" 
        type="slam_gmapping" 
        name="slam_gmapping"
        output="screen">
    <rosparam command="load" file="$(find elderly_bot)/config/gmapping.yaml" />
  </node>
  
  <!-- ========== EXPLORE LITE (AUTONOMOUS EXPLORATION) ========== -->
  
  <node pkg="explore_lite" 
        type="explore" 
        name="explore"
        output="screen">
    
    <!-- Robot radius for obstacle checking -->
    <param name="robot_base_frame" value="base_link" />
    <param name="costmap_topic" value="map" />
    <param name="costmap_updates_topic" value="map_updates" />
    <param name="visualize" value="true" />
    
    <!-- Exploration parameters -->
    <param name="planner_frequency" value="0.5" />
    <param name="progress_timeout" value="30.0" />
    <param name="potential_scale" value="3.0" />
    <param name="orientation_scale" value="0.0" />
    <param name="gain_scale" value="1.0" />
    <param name="transform_tolerance" value="0.3" />
    <param name="min_frontier_size" value="0.5" />
    
  </node>
  
  <!-- ========== RVIZ VISUALIZATION ========== -->
  <!-- Note: Starts with default config. Manually add displays for /map, /scan, /tf -->
  <!-- Enable with: roslaunch elderly_bot mapping.launch rviz:=true -->
  
  <node name="rviz" 
        pkg="rviz" 
        type="rviz" 
        required="false"
        if="$(arg rviz)" />
  
</launch>


